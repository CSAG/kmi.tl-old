// Generated by CoffeeScript 1.6.3
(function() {
  angular.module('kmitl', []).controller('UrlShortenerCtrl', [
    '$scope', '$http', function($scope, $http) {
      var ele;
      ele = angular.element;
      $scope.urls = [];
      $scope.inputUrl = '';
      $scope.inputUrlClass = '';
      $scope.insertUrl = function(event) {
        if (event.keyCode === 13) {
          if (/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)/.test($scope.inputUrl)) {
            $scope.inputUrlClass = '';
            return $http.post('pages/ajax_add_url.json', {
              url: $scope.inputUrl
            }).success(function(data) {
              $scope.urls.push(data);
              $scope.inputUrl = data.short;
              return ele('#inputUrl')[0].select();
            });
          } else {
            return $scope.inputUrlClass = 'has-error';
          }
        }
      };
      return $scope.clickInputUrl = function() {
        return ele('#inputUrl')[0].select();
      };
    }
  ]);

}).call(this);
